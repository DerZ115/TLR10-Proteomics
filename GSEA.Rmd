---
title: "Functional Analysis"
output:
  html_document:
    df_print: paged
    toc: true
    toc_float: true
---

# Setup

```{r setup}

library(tidyverse)
library(clusterProfiler)
library(org.Hs.eg.db)
library(enrichplot)
library(pathview)
library(DOSE)

knitr::opts_chunk$set(fig.width = 10, out.width = "100%", dpi = 300)

dir.create(path = "./results/GSEA", showWarnings = FALSE)

```


# Undifferentiated - Supernatant

## ASC WT Light vs. Dark 

```{r ASC_WT_Light_vs_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_WT_Light_vs_Dark_SN/"

dir.create(results_dir)

res.ASC_WT_Light_vs_Dark <- read.csv("results/DEA/ASC_WT_Light_vs_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_WT_Light_vs_Dark <- res.ASC_WT_Light_vs_Dark$logFC
names(gene_list.ASC_WT_Light_vs_Dark) <- res.ASC_WT_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_WT_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_WT_Light_vs_Dark.entrez <- gene_list.ASC_WT_Light_vs_Dark[names(gene_list.ASC_WT_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ASC_WT_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ASC_WT_Light_vs_Dark.entrez <- gene_list.ASC_WT_Light_vs_Dark.entrez[!duplicated(names(gene_list.ASC_WT_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_WT_Light_vs_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.ASC_WT_Light_vs_Dark <- gseGO(gene_list.ASC_WT_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_WT_Light_vs_Dark <- simplify(gseGO_BP.ASC_WT_Light_vs_Dark)
gseGO_BP.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_SN_go_bp_dotplot, eval=ASC_WT_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_SN_go_bp_netplot, eval=ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_SN_go_bp_mapplot, eval=ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ASC_WT_Light_vs_Dark)

emapplot(gseGO_BP.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_WT_Light_vs_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.ASC_WT_Light_vs_Dark <- gseGO(gene_list.ASC_WT_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_MF.ASC_WT_Light_vs_Dark <- simplify(gseGO_MF.ASC_WT_Light_vs_Dark)
gseGO_MF.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_SN_go_mf_dotplot, eval=ASC_WT_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_SN_go_mf_netplot, eval=ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_SN_go_mf_mapplot, eval=ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ASC_WT_Light_vs_Dark)

emapplot(gseGO_MF.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_WT_Light_vs_Dark_SN_go_cc, warning=FALSE}


gseGO_CC.ASC_WT_Light_vs_Dark <- gseGO(gene_list.ASC_WT_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ASC_WT_Light_vs_Dark <- simplify(gseGO_CC.ASC_WT_Light_vs_Dark)        
gseGO_CC.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_SN_go_cc_dotplot, eval=ASC_WT_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_SN_go_cc_netplot, eval=ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_SN_go_cc_mapplot, eval=ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ASC_WT_Light_vs_Dark)

emapplot(gseGO_CC.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_WT_Light_vs_Dark_SN_kegg, warning=FALSE}

gseKEGG.ASC_WT_Light_vs_Dark <- gseKEGG(gene_list.ASC_WT_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_WT_Light_vs_Dark <- setReadable(gseKEGG.ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_SN_kegg_dotplot, eval=ASC_WT_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_SN_kegg_netplot, eval=ASC_WT_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_SN_kegg_mapplot, eval=ASC_WT_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ASC_WT_Light_vs_Dark)

emapplot(gseKEGG.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_SN_kegg_pathview, eval=ASC_WT_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ASC_WT_Light_vs_Dark.entrez, pathway.id = gseKEGG.ASC_WT_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_WT_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_WT_Light_vs_Dark_SN_do, warning=FALSE}

gseDO.ASC_WT_Light_vs_Dark <- gseDO(gene_list.ASC_WT_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_WT_Light_vs_Dark <- setReadable(gseDO.ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.DO.plot <- nrow(gseDO.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_SN_do_dotplot, eval=ASC_WT_Light_vs_Dark.DO.plot}

dotplot(gseDO.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_SN_do_netplot, eval=ASC_WT_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_WT_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_SN_do_mapplot, eval=ASC_WT_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ASC_WT_Light_vs_Dark)

emapplot(gseDO.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC TLR10LOV Light vs. Dark 

```{r ASC_TLR10LOV_Light_vs_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_TLR10LOV_Light_vs_Dark_SN/"

dir.create(results_dir)

res.ASC_TLR10LOV_Light_vs_Dark <- read.csv("results/DEA/ASC_TLR10LOV_Light_vs_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_TLR10LOV_Light_vs_Dark <- res.ASC_TLR10LOV_Light_vs_Dark$logFC
names(gene_list.ASC_TLR10LOV_Light_vs_Dark) <- res.ASC_TLR10LOV_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_TLR10LOV_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ASC_TLR10LOV_Light_vs_Dark[names(gene_list.ASC_TLR10LOV_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez[!duplicated(names(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark)
gseGO_BP.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_MF.ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark)  
gseGO_MF.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_cc, warning=FALSE}

gseGO_CC.ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                 
gseGO_CC.ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark)   
gseGO_CC.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_TLR10LOV_Light_vs_Dark_SN_kegg, warning=FALSE}

gseKEGG.ASC_TLR10LOV_Light_vs_Dark <- gseKEGG(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseKEGG.ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_kegg_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_kegg_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_kegg_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseKEGG.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_kegg_pathview, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez, pathway.id = gseKEGG.ASC_TLR10LOV_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_TLR10LOV_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_TLR10LOV_Light_vs_Dark_SN_do, warning=FALSE}

gseDO.ASC_TLR10LOV_Light_vs_Dark <- gseDO(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseDO.ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.DO.plot <- nrow(gseDO.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_do_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.DO.plot}

dotplot(gseDO.ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_do_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_SN_do_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseDO.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC TLR10LOV vs. WT Dark

```{r ASC_TLR10LOV_vs_WT_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_TLR10LOV_vs_WT_Dark_SN/"

dir.create(results_dir)

res.ASC_TLR10LOV_vs_WT_Dark <- read.csv("results/DEA/ASC_TLR10LOV_vs_WT_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_TLR10LOV_vs_WT_Dark <- res.ASC_TLR10LOV_vs_WT_Dark$logFC
names(gene_list.ASC_TLR10LOV_vs_WT_Dark) <- res.ASC_TLR10LOV_vs_WT_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_TLR10LOV_vs_WT_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Dark[names(gene_list.ASC_TLR10LOV_vs_WT_Dark) %in% ids$SYMBOL]
names(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez) <- ids$ENTREZID
gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez[!duplicated(names(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark)
gseGO_BP.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.go_bp.plot <- nrow(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_bp.plot}

dotplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                             
gseGO_MF.ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark)      
gseGO_MF.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.go_mf.plot <- nrow(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_mf.plot}

dotplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_cc, warning=FALSE}

gseGO_CC.ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_CC.ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark)
gseGO_CC.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.go_cc.plot <- nrow(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_cc.plot}

dotplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_TLR10LOV_vs_WT_Dark_SN_kegg, warning=FALSE}

gseKEGG.ASC_TLR10LOV_vs_WT_Dark <- gseKEGG(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseKEGG.ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.kegg.plot <- nrow(gseKEGG.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_kegg_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

dotplot(gseKEGG.ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_kegg_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_kegg_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=9}
gseKEGG.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseKEGG.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseKEGG.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_kegg_pathview, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

pathview(gene.data = gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez, pathway.id = gseKEGG.ASC_TLR10LOV_vs_WT_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_TLR10LOV_vs_WT_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_TLR10LOV_vs_WT_Dark_SN_do, warning=FALSE}

gseDO.ASC_TLR10LOV_vs_WT_Dark <- gseDO(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseDO.ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.DO.plot <- nrow(gseDO.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_do_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.DO.plot}

dotplot(gseDO.ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_do_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_SN_do_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=9}

gseDO.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseDO.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseDO.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC TLR10LOV vs. WT Light 

```{r ASC_TLR10LOV_vs_WT_Light_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_TLR10LOV_vs_WT_Light_SN/"

dir.create(results_dir)

res.ASC_TLR10LOV_vs_WT_Light <- read.csv("results/DEA/ASC_TLR10LOV_vs_WT_Light_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_TLR10LOV_vs_WT_Light <- res.ASC_TLR10LOV_vs_WT_Light$logFC
names(gene_list.ASC_TLR10LOV_vs_WT_Light) <- res.ASC_TLR10LOV_vs_WT_Light$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_TLR10LOV_vs_WT_Light), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Light[names(gene_list.ASC_TLR10LOV_vs_WT_Light) %in% ids$SYMBOL]
names(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez) <- ids$ENTREZID
gene_list.ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Light.entrez[!duplicated(names(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_bp, warning=FALSE}

gseGO_BP.ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Light,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_BP.ASC_TLR10LOV_vs_WT_Light)
gseGO_BP.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.go_bp.plot <- nrow(gseGO_BP.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_bp_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.go_bp.plot}

dotplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_bp_netplot, eval=ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_bp_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=9}
gseGO_BP.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_BP.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_mf, warning=FALSE}

gseGO_MF.ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Light,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                         
gseGO_MF.ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_MF.ASC_TLR10LOV_vs_WT_Light)           
gseGO_MF.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.go_mf.plot <- nrow(gseGO_MF.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_mf_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.go_mf.plot}

dotplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_mf_netplot, eval=ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_mf_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=9}
gseGO_MF.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_MF.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_cc, warning=FALSE}

gseGO_CC.ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Light,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_CC.ASC_TLR10LOV_vs_WT_Light)        
gseGO_CC.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.go_cc.plot <- nrow(gseGO_CC.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_cc_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.go_cc.plot}

dotplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_cc_netplot, eval=ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_go_cc_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=9}
gseGO_CC.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_CC.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_TLR10LOV_vs_WT_Light_SN_kegg, warning=FALSE}

gseKEGG.ASC_TLR10LOV_vs_WT_Light <- gseKEGG(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_TLR10LOV_vs_WT_Light <- setReadable(gseKEGG.ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.kegg.plot <- nrow(gseKEGG.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_kegg_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot}

dotplot(gseKEGG.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_kegg_netplot, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_kegg_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=9}
gseKEGG.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseKEGG.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseKEGG.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_kegg_pathview, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot}

pathview(gene.data = gene_list.ASC_TLR10LOV_vs_WT_Light.entrez, pathway.id = gseKEGG.ASC_TLR10LOV_vs_WT_Light@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_TLR10LOV_vs_WT_Light@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_TLR10LOV_vs_WT_Light_SN_do, warning=FALSE}


gseDO.ASC_TLR10LOV_vs_WT_Light <- gseDO(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_TLR10LOV_vs_WT_Light <- setReadable(gseDO.ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.DO.plot <- nrow(gseDO.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.DO.plot) {
  write.csv(data.frame(gseDO.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_do_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.DO.plot}

dotplot(gseDO.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_do_netplot, eval=ASC_TLR10LOV_vs_WT_Light.DO.plot}

cnetplot(gseDO.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_SN_do_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.DO.plot}

gseDO.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseDO.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseDO.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC Interaction (TLR10LOV Light vs. Dark) vs. (Wildtype Light vs. Dark)

```{r ASC_Interaction_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_Interaction_SN/"

dir.create(results_dir)

res.ASC_Interaction <- read.csv("results/DEA/ASC_Interaction_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_Interaction <- res.ASC_Interaction$logFC
names(gene_list.ASC_Interaction) <- res.ASC_Interaction$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_Interaction), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_Interaction.entrez <- gene_list.ASC_Interaction[names(gene_list.ASC_Interaction) %in% ids$SYMBOL]
names(gene_list.ASC_Interaction.entrez) <- ids$ENTREZID
gene_list.ASC_Interaction.entrez <- gene_list.ASC_Interaction.entrez[!duplicated(names(gene_list.ASC_Interaction.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_Interaction_SN_go_bp, warning=FALSE}


gseGO_BP.ASC_Interaction <- gseGO(gene_list.ASC_Interaction,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_Interaction <- simplify(gseGO_BP.ASC_Interaction)
gseGO_BP.ASC_Interaction

ASC_Interaction.go_bp.plot <- nrow(gseGO_BP.ASC_Interaction) > 0

if (ASC_Interaction.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_Interaction_SN_go_bp_dotplot, eval=ASC_Interaction.go_bp.plot}

dotplot(gseGO_BP.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_SN_go_bp_netplot, eval=ASC_Interaction.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_SN_go_bp_mapplot, eval=ASC_Interaction.go_bp.plot, fig.height=9}
gseGO_BP.ASC_Interaction.pwts <- pairwise_termsim(gseGO_BP.ASC_Interaction)

emapplot(gseGO_BP.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_Interaction_SN_go_mf, warning=FALSE}

gseGO_MF.ASC_Interaction <- gseGO(gene_list.ASC_Interaction,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
            
gseGO_MF.ASC_Interaction <- simplify(gseGO_MF.ASC_Interaction)                        
gseGO_MF.ASC_Interaction

ASC_Interaction.go_mf.plot <- nrow(gseGO_MF.ASC_Interaction) > 0

if (ASC_Interaction.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_Interaction_SN_go_mf_dotplot, eval=ASC_Interaction.go_mf.plot}

dotplot(gseGO_MF.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_SN_go_mf_netplot, eval=ASC_Interaction.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_SN_go_mf_mapplot, eval=ASC_Interaction.go_mf.plot, fig.height=9}
gseGO_MF.ASC_Interaction.pwts <- pairwise_termsim(gseGO_MF.ASC_Interaction)

emapplot(gseGO_MF.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_Interaction_SN_go_cc, warning=FALSE}

gseGO_CC.ASC_Interaction <- gseGO(gene_list.ASC_Interaction,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
             
gseGO_CC.ASC_Interaction <- simplify(gseGO_CC.ASC_Interaction)                       
gseGO_CC.ASC_Interaction

ASC_Interaction.go_cc.plot <- nrow(gseGO_CC.ASC_Interaction) > 0

if (ASC_Interaction.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_Interaction_SN_go_cc_dotplot, eval=ASC_Interaction.go_cc.plot}

dotplot(gseGO_CC.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_SN_go_cc_netplot, eval=ASC_Interaction.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_SN_go_cc_mapplot, eval=ASC_Interaction.go_cc.plot, fig.height=9}
gseGO_CC.ASC_Interaction.pwts <- pairwise_termsim(gseGO_CC.ASC_Interaction)

emapplot(gseGO_CC.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_Interaction_SN_kegg, warning=FALSE}

gseKEGG.ASC_Interaction <- gseKEGG(gene_list.ASC_Interaction.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_Interaction <- setReadable(gseKEGG.ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_Interaction

ASC_Interaction.kegg.plot <- nrow(gseKEGG.ASC_Interaction) > 0

if (ASC_Interaction.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_Interaction), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_Interaction_SN_kegg_dotplot, eval=ASC_Interaction.kegg.plot}

dotplot(gseKEGG.ASC_Interaction, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_SN_kegg_netplot, eval=ASC_Interaction.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_SN_kegg_mapplot, eval=ASC_Interaction.kegg.plot, fig.height=9}
gseKEGG.ASC_Interaction.pwts <- pairwise_termsim(gseKEGG.ASC_Interaction)

emapplot(gseKEGG.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_SN_kegg_pathview, eval=ASC_Interaction.kegg.plot}

pathview(gene.data = gene_list.ASC_Interaction.entrez, pathway.id = gseKEGG.ASC_Interaction@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_Interaction@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_Interaction_SN_do, warning=FALSE}

gseDO.ASC_Interaction <- gseDO(gene_list.ASC_Interaction.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_Interaction <- setReadable(gseDO.ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_Interaction

ASC_Interaction.DO.plot <- nrow(gseDO.ASC_Interaction) > 0

if (ASC_Interaction.DO.plot) {
  write.csv(data.frame(gseDO.ASC_Interaction), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_Interaction_SN_do_dotplot, eval=ASC_Interaction.DO.plot}

dotplot(gseDO.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_SN_do_netplot, eval=ASC_Interaction.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_Interaction, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_SN_do_mapplot, eval=ASC_Interaction.DO.plot, fig.height=9}

gseDO.ASC_Interaction.pwts <- pairwise_termsim(gseDO.ASC_Interaction)

emapplot(gseDO.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


# Undifferentiated - Whole Cell Lysate

## ASC WT Light vs. Dark 

```{r ASC_WT_Light_vs_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_WT_Light_vs_Dark_WCL/"

dir.create(results_dir)

res.ASC_WT_Light_vs_Dark <- read.csv("results/DEA/ASC_WT_Light_vs_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_WT_Light_vs_Dark <- res.ASC_WT_Light_vs_Dark$logFC
names(gene_list.ASC_WT_Light_vs_Dark) <- res.ASC_WT_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_WT_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_WT_Light_vs_Dark.entrez <- gene_list.ASC_WT_Light_vs_Dark[names(gene_list.ASC_WT_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ASC_WT_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ASC_WT_Light_vs_Dark.entrez <- gene_list.ASC_WT_Light_vs_Dark.entrez[!duplicated(names(gene_list.ASC_WT_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_WT_Light_vs_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.ASC_WT_Light_vs_Dark <- gseGO(gene_list.ASC_WT_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_WT_Light_vs_Dark <- simplify(gseGO_BP.ASC_WT_Light_vs_Dark)
gseGO_BP.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_WCL_go_bp_dotplot, eval=ASC_WT_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_WCL_go_bp_netplot, eval=ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_WCL_go_bp_mapplot, eval=ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ASC_WT_Light_vs_Dark)

emapplot(gseGO_BP.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_WT_Light_vs_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.ASC_WT_Light_vs_Dark <- gseGO(gene_list.ASC_WT_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_MF.ASC_WT_Light_vs_Dark <- simplify(gseGO_MF.ASC_WT_Light_vs_Dark)
gseGO_MF.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_WCL_go_mf_dotplot, eval=ASC_WT_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_WCL_go_mf_netplot, eval=ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_WCL_go_mf_mapplot, eval=ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ASC_WT_Light_vs_Dark)

emapplot(gseGO_MF.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_WT_Light_vs_Dark_WCL_go_cc, warning=FALSE}


gseGO_CC.ASC_WT_Light_vs_Dark <- gseGO(gene_list.ASC_WT_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ASC_WT_Light_vs_Dark <- simplify(gseGO_CC.ASC_WT_Light_vs_Dark)        
gseGO_CC.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_WCL_go_cc_dotplot, eval=ASC_WT_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_WCL_go_cc_netplot, eval=ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_WCL_go_cc_mapplot, eval=ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ASC_WT_Light_vs_Dark)

emapplot(gseGO_CC.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_WT_Light_vs_Dark_WCL_kegg, warning=FALSE}

gseKEGG.ASC_WT_Light_vs_Dark <- gseKEGG(gene_list.ASC_WT_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_WT_Light_vs_Dark <- setReadable(gseKEGG.ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_WCL_kegg_dotplot, eval=ASC_WT_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_WCL_kegg_netplot, eval=ASC_WT_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_WCL_kegg_mapplot, eval=ASC_WT_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ASC_WT_Light_vs_Dark)

emapplot(gseKEGG.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_WCL_kegg_pathview, eval=ASC_WT_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ASC_WT_Light_vs_Dark.entrez, pathway.id = gseKEGG.ASC_WT_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_WT_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_WT_Light_vs_Dark_WCL_do, warning=FALSE}

gseDO.ASC_WT_Light_vs_Dark <- gseDO(gene_list.ASC_WT_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_WT_Light_vs_Dark <- setReadable(gseDO.ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_WT_Light_vs_Dark

ASC_WT_Light_vs_Dark.DO.plot <- nrow(gseDO.ASC_WT_Light_vs_Dark) > 0

if (ASC_WT_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_WT_Light_vs_Dark_WCL_do_dotplot, eval=ASC_WT_Light_vs_Dark.DO.plot}

dotplot(gseDO.ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_WT_Light_vs_Dark_WCL_do_netplot, eval=ASC_WT_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_WT_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_WT_Light_vs_Dark_WCL_do_mapplot, eval=ASC_WT_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ASC_WT_Light_vs_Dark)

emapplot(gseDO.ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC TLR10LOV Light vs. Dark 

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_TLR10LOV_Light_vs_Dark_WCL/"

dir.create(results_dir)

res.ASC_TLR10LOV_Light_vs_Dark <- read.csv("results/DEA/ASC_TLR10LOV_Light_vs_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_TLR10LOV_Light_vs_Dark <- res.ASC_TLR10LOV_Light_vs_Dark$logFC
names(gene_list.ASC_TLR10LOV_Light_vs_Dark) <- res.ASC_TLR10LOV_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_TLR10LOV_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ASC_TLR10LOV_Light_vs_Dark[names(gene_list.ASC_TLR10LOV_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez[!duplicated(names(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark)
gseGO_BP.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_BP.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_MF.ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark)  
gseGO_MF.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_MF.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc, warning=FALSE}

gseGO_CC.ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                 
gseGO_CC.ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark)   
gseGO_CC.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_CC.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_kegg, warning=FALSE}

gseKEGG.ASC_TLR10LOV_Light_vs_Dark <- gseKEGG(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseKEGG.ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseKEGG.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_pathview, eval=ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez, pathway.id = gseKEGG.ASC_TLR10LOV_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_TLR10LOV_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_do, warning=FALSE}

gseDO.ASC_TLR10LOV_Light_vs_Dark <- gseDO(gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseDO.ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_TLR10LOV_Light_vs_Dark

ASC_TLR10LOV_Light_vs_Dark.DO.plot <- nrow(gseDO.ASC_TLR10LOV_Light_vs_Dark) > 0

if (ASC_TLR10LOV_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_do_dotplot, eval=ASC_TLR10LOV_Light_vs_Dark.DO.plot}

dotplot(gseDO.ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_do_netplot, eval=ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_Light_vs_Dark_WCL_do_mapplot, eval=ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseDO.ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC TLR10LOV vs. WT Dark

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_TLR10LOV_vs_WT_Dark_WCL/"

dir.create(results_dir)

res.ASC_TLR10LOV_vs_WT_Dark <- read.csv("results/DEA/ASC_TLR10LOV_vs_WT_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_TLR10LOV_vs_WT_Dark <- res.ASC_TLR10LOV_vs_WT_Dark$logFC
names(gene_list.ASC_TLR10LOV_vs_WT_Dark) <- res.ASC_TLR10LOV_vs_WT_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_TLR10LOV_vs_WT_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Dark[names(gene_list.ASC_TLR10LOV_vs_WT_Dark) %in% ids$SYMBOL]
names(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez) <- ids$ENTREZID
gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez[!duplicated(names(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark)
gseGO_BP.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.go_bp.plot <- nrow(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_bp.plot}

dotplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                             
gseGO_MF.ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark)      
gseGO_MF.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.go_mf.plot <- nrow(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_mf.plot}

dotplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc, warning=FALSE}

gseGO_CC.ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_CC.ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark)
gseGO_CC.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.go_cc.plot <- nrow(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_cc.plot}

dotplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_kegg, warning=FALSE}

gseKEGG.ASC_TLR10LOV_vs_WT_Dark <- gseKEGG(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseKEGG.ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.kegg.plot <- nrow(gseKEGG.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

dotplot(gseKEGG.ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=9}
gseKEGG.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseKEGG.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseKEGG.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_pathview, eval=ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

pathview(gene.data = gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez, pathway.id = gseKEGG.ASC_TLR10LOV_vs_WT_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_TLR10LOV_vs_WT_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_do, warning=FALSE}

gseDO.ASC_TLR10LOV_vs_WT_Dark <- gseDO(gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseDO.ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_TLR10LOV_vs_WT_Dark

ASC_TLR10LOV_vs_WT_Dark.DO.plot <- nrow(gseDO.ASC_TLR10LOV_vs_WT_Dark) > 0

if (ASC_TLR10LOV_vs_WT_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_do_dotplot, eval=ASC_TLR10LOV_vs_WT_Dark.DO.plot}

dotplot(gseDO.ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_do_netplot, eval=ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Dark_WCL_do_mapplot, eval=ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=9}

gseDO.ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseDO.ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseDO.ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC TLR10LOV vs. WT Light 

```{r ASC_TLR10LOV_vs_WT_Light_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_TLR10LOV_vs_WT_Light_WCL/"

dir.create(results_dir)

res.ASC_TLR10LOV_vs_WT_Light <- read.csv("results/DEA/ASC_TLR10LOV_vs_WT_Light_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_TLR10LOV_vs_WT_Light <- res.ASC_TLR10LOV_vs_WT_Light$logFC
names(gene_list.ASC_TLR10LOV_vs_WT_Light) <- res.ASC_TLR10LOV_vs_WT_Light$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_TLR10LOV_vs_WT_Light), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Light[names(gene_list.ASC_TLR10LOV_vs_WT_Light) %in% ids$SYMBOL]
names(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez) <- ids$ENTREZID
gene_list.ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ASC_TLR10LOV_vs_WT_Light.entrez[!duplicated(names(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_bp, warning=FALSE}

gseGO_BP.ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Light,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_BP.ASC_TLR10LOV_vs_WT_Light)
gseGO_BP.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.go_bp.plot <- nrow(gseGO_BP.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.go_bp.plot}

dotplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_netplot, eval=ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=9}
gseGO_BP.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_BP.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_BP.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_mf, warning=FALSE}

gseGO_MF.ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Light,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                         
gseGO_MF.ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_MF.ASC_TLR10LOV_vs_WT_Light)           
gseGO_MF.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.go_mf.plot <- nrow(gseGO_MF.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.go_mf.plot}

dotplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_netplot, eval=ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=9}
gseGO_MF.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_MF.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_MF.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_cc, warning=FALSE}

gseGO_CC.ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ASC_TLR10LOV_vs_WT_Light,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_CC.ASC_TLR10LOV_vs_WT_Light)        
gseGO_CC.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.go_cc.plot <- nrow(gseGO_CC.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.go_cc.plot}

dotplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_netplot, eval=ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=9}
gseGO_CC.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_CC.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_CC.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_TLR10LOV_vs_WT_Light_WCL_kegg, warning=FALSE}

gseKEGG.ASC_TLR10LOV_vs_WT_Light <- gseKEGG(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_TLR10LOV_vs_WT_Light <- setReadable(gseKEGG.ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.kegg.plot <- nrow(gseKEGG.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_kegg_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot}

dotplot(gseKEGG.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_kegg_netplot, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_kegg_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=9}
gseKEGG.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseKEGG.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseKEGG.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_kegg_pathview, eval=ASC_TLR10LOV_vs_WT_Light.kegg.plot}

pathview(gene.data = gene_list.ASC_TLR10LOV_vs_WT_Light.entrez, pathway.id = gseKEGG.ASC_TLR10LOV_vs_WT_Light@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_TLR10LOV_vs_WT_Light@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_TLR10LOV_vs_WT_Light_WCL_do, warning=FALSE}


gseDO.ASC_TLR10LOV_vs_WT_Light <- gseDO(gene_list.ASC_TLR10LOV_vs_WT_Light.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_TLR10LOV_vs_WT_Light <- setReadable(gseDO.ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_TLR10LOV_vs_WT_Light

ASC_TLR10LOV_vs_WT_Light.DO.plot <- nrow(gseDO.ASC_TLR10LOV_vs_WT_Light) > 0

if (ASC_TLR10LOV_vs_WT_Light.DO.plot) {
  write.csv(data.frame(gseDO.ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_do_dotplot, eval=ASC_TLR10LOV_vs_WT_Light.DO.plot}

dotplot(gseDO.ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_do_netplot, eval=ASC_TLR10LOV_vs_WT_Light.DO.plot}

cnetplot(gseDO.ASC_TLR10LOV_vs_WT_Light, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_TLR10LOV_vs_WT_Light_WCL_do_mapplot, eval=ASC_TLR10LOV_vs_WT_Light.DO.plot}

gseDO.ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseDO.ASC_TLR10LOV_vs_WT_Light)

emapplot(gseDO.ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## ASC Interaction (TLR10LOV Light vs. Dark) vs. (Wildtype Light vs. Dark)

```{r ASC_Interaction_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ASC_Interaction_WCL/"

dir.create(results_dir)

res.ASC_Interaction <- read.csv("results/DEA/ASC_Interaction_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ASC_Interaction <- res.ASC_Interaction$logFC
names(gene_list.ASC_Interaction) <- res.ASC_Interaction$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ASC_Interaction), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ASC_Interaction.entrez <- gene_list.ASC_Interaction[names(gene_list.ASC_Interaction) %in% ids$SYMBOL]
names(gene_list.ASC_Interaction.entrez) <- ids$ENTREZID
gene_list.ASC_Interaction.entrez <- gene_list.ASC_Interaction.entrez[!duplicated(names(gene_list.ASC_Interaction.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ASC_Interaction_WCL_go_bp, warning=FALSE}


gseGO_BP.ASC_Interaction <- gseGO(gene_list.ASC_Interaction,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ASC_Interaction <- simplify(gseGO_BP.ASC_Interaction)
gseGO_BP.ASC_Interaction

ASC_Interaction.go_bp.plot <- nrow(gseGO_BP.ASC_Interaction) > 0

if (ASC_Interaction.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_Interaction_WCL_go_bp_dotplot, eval=ASC_Interaction.go_bp.plot}

dotplot(gseGO_BP.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_WCL_go_bp_netplot, eval=ASC_Interaction.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_WCL_go_bp_mapplot, eval=ASC_Interaction.go_bp.plot, fig.height=9}
gseGO_BP.ASC_Interaction.pwts <- pairwise_termsim(gseGO_BP.ASC_Interaction)

emapplot(gseGO_BP.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ASC_Interaction_WCL_go_mf, warning=FALSE}

gseGO_MF.ASC_Interaction <- gseGO(gene_list.ASC_Interaction,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
            
gseGO_MF.ASC_Interaction <- simplify(gseGO_MF.ASC_Interaction)                        
gseGO_MF.ASC_Interaction

ASC_Interaction.go_mf.plot <- nrow(gseGO_MF.ASC_Interaction) > 0

if (ASC_Interaction.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_Interaction_WCL_go_mf_dotplot, eval=ASC_Interaction.go_mf.plot}

dotplot(gseGO_MF.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_WCL_go_mf_netplot, eval=ASC_Interaction.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_WCL_go_mf_mapplot, eval=ASC_Interaction.go_mf.plot, fig.height=9}
gseGO_MF.ASC_Interaction.pwts <- pairwise_termsim(gseGO_MF.ASC_Interaction)

emapplot(gseGO_MF.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ASC_Interaction_WCL_go_cc, warning=FALSE}

gseGO_CC.ASC_Interaction <- gseGO(gene_list.ASC_Interaction,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
             
gseGO_CC.ASC_Interaction <- simplify(gseGO_CC.ASC_Interaction)                       
gseGO_CC.ASC_Interaction

ASC_Interaction.go_cc.plot <- nrow(gseGO_CC.ASC_Interaction) > 0

if (ASC_Interaction.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ASC_Interaction_WCL_go_cc_dotplot, eval=ASC_Interaction.go_cc.plot}

dotplot(gseGO_CC.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_WCL_go_cc_netplot, eval=ASC_Interaction.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_WCL_go_cc_mapplot, eval=ASC_Interaction.go_cc.plot, fig.height=9}
gseGO_CC.ASC_Interaction.pwts <- pairwise_termsim(gseGO_CC.ASC_Interaction)

emapplot(gseGO_CC.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ASC_Interaction_WCL_kegg, warning=FALSE}

gseKEGG.ASC_Interaction <- gseKEGG(gene_list.ASC_Interaction.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ASC_Interaction <- setReadable(gseKEGG.ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ASC_Interaction

ASC_Interaction.kegg.plot <- nrow(gseKEGG.ASC_Interaction) > 0

if (ASC_Interaction.kegg.plot) {
  write.csv(data.frame(gseKEGG.ASC_Interaction), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ASC_Interaction_WCL_kegg_dotplot, eval=ASC_Interaction.kegg.plot}

dotplot(gseKEGG.ASC_Interaction, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_WCL_kegg_netplot, eval=ASC_Interaction.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_WCL_kegg_mapplot, eval=ASC_Interaction.kegg.plot, fig.height=9}
gseKEGG.ASC_Interaction.pwts <- pairwise_termsim(gseKEGG.ASC_Interaction)

emapplot(gseKEGG.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_WCL_kegg_pathview, eval=ASC_Interaction.kegg.plot}

pathview(gene.data = gene_list.ASC_Interaction.entrez, pathway.id = gseKEGG.ASC_Interaction@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ASC_Interaction@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ASC_Interaction_WCL_do, warning=FALSE}

gseDO.ASC_Interaction <- gseDO(gene_list.ASC_Interaction.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ASC_Interaction <- setReadable(gseDO.ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseDO.ASC_Interaction

ASC_Interaction.DO.plot <- nrow(gseDO.ASC_Interaction) > 0

if (ASC_Interaction.DO.plot) {
  write.csv(data.frame(gseDO.ASC_Interaction), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ASC_Interaction_WCL_do_dotplot, eval=ASC_Interaction.DO.plot}

dotplot(gseDO.ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ASC_Interaction_WCL_do_netplot, eval=ASC_Interaction.DO.plot, fig.height=10}

cnetplot(gseDO.ASC_Interaction, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ASC_Interaction_WCL_do_mapplot, eval=ASC_Interaction.DO.plot, fig.height=9}

gseDO.ASC_Interaction.pwts <- pairwise_termsim(gseDO.ASC_Interaction)

emapplot(gseDO.ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


# Adipo ASC - Supernatant

## Adipo ASC WT Light vs. Dark 

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_WT_Light_vs_Dark_SN/"

dir.create(results_dir)

res.ADIPO_ASC_WT_Light_vs_Dark <- read.csv("results/DEA/ADIPO_ASC_WT_Light_vs_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_WT_Light_vs_Dark <- res.ADIPO_ASC_WT_Light_vs_Dark$logFC
names(gene_list.ADIPO_ASC_WT_Light_vs_Dark) <- res.ADIPO_ASC_WT_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_WT_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_WT_Light_vs_Dark[names(gene_list.ADIPO_ASC_WT_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez[!duplicated(names(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_WT_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark <- simplify(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark)
gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_bp_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_bp_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_bp_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_WT_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark <- simplify(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark)
gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_mf_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_mf_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_mf_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_cc, warning=FALSE}


gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_WT_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark <- simplify(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark)        
gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_cc_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_cc_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_go_cc_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_WT_Light_vs_Dark <- gseKEGG(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_WT_Light_vs_Dark <- setReadable(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_kegg_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_kegg_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_kegg_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_kegg_pathview, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez, pathway.id = gseKEGG.ADIPO_ASC_WT_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_do, warning=FALSE}

gseDO.ADIPO_ASC_WT_Light_vs_Dark <- gseDO(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_WT_Light_vs_Dark <- setReadable(gseDO.ADIPO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.DO.plot <- nrow(gseDO.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_do_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.DO.plot}

dotplot(gseDO.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_do_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_SN_do_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseDO.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC TLR10LOV Light vs. Dark 

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN/"

dir.create(results_dir)

res.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- read.csv("results/DEA/ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- res.ADIPO_ASC_TLR10LOV_Light_vs_Dark$logFC
names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark) <- res.ADIPO_ASC_TLR10LOV_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark[names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez[!duplicated(names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark)
gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark)  
gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                 
gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark)   
gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseKEGG(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_pathview, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez, pathway.id = gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_do, warning=FALSE}

gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseDO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot <- nrow(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_do_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot}

dotplot(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_do_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_SN_do_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC TLR10LOV vs. WT Dark

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN/"

dir.create(results_dir)

res.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- read.csv("results/DEA/ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- res.ADIPO_ASC_TLR10LOV_vs_WT_Dark$logFC
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark) <- res.ADIPO_ASC_TLR10LOV_vs_WT_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark[names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez[!duplicated(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                             
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark)      
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseKEGG(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_pathview, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez, pathway.id = gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_do, warning=FALSE}

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseDO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot <- nrow(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_do_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot}

dotplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_do_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_SN_do_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC TLR10LOV vs. WT Light 

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_TLR10LOV_vs_WT_Light_SN/"

dir.create(results_dir)

res.ADIPO_ASC_TLR10LOV_vs_WT_Light <- read.csv("results/DEA/ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light <- res.ADIPO_ASC_TLR10LOV_vs_WT_Light$logFC
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light) <- res.ADIPO_ASC_TLR10LOV_vs_WT_Light$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light[names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez[!duplicated(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light)
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                         
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light)           
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light)        
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseKEGG(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_pathview, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez, pathway.id = gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_do, warning=FALSE}


gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseDO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot <- nrow(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_do_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

dotplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_do_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

cnetplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_SN_do_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC Interaction (TLR10LOV Light vs. Dark) vs. (Wildtype Light vs. Dark)

```{r ADIPO_ASC_Interaction_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_Interaction_SN/"

dir.create(results_dir)

res.ADIPO_ASC_Interaction <- read.csv("results/DEA/ADIPO_ASC_Interaction_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_Interaction <- res.ADIPO_ASC_Interaction$logFC
names(gene_list.ADIPO_ASC_Interaction) <- res.ADIPO_ASC_Interaction$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_Interaction), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_Interaction.entrez <- gene_list.ADIPO_ASC_Interaction[names(gene_list.ADIPO_ASC_Interaction) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_Interaction.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_Interaction.entrez <- gene_list.ADIPO_ASC_Interaction.entrez[!duplicated(names(gene_list.ADIPO_ASC_Interaction.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_Interaction_SN_go_bp, warning=FALSE}


gseGO_BP.ADIPO_ASC_Interaction <- gseGO(gene_list.ADIPO_ASC_Interaction,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_Interaction <- simplify(gseGO_BP.ADIPO_ASC_Interaction)
gseGO_BP.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_SN_go_bp_dotplot, eval=ADIPO_ASC_Interaction.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_SN_go_bp_netplot, eval=ADIPO_ASC_Interaction.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_SN_go_bp_mapplot, eval=ADIPO_ASC_Interaction.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_Interaction)

emapplot(gseGO_BP.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_Interaction_SN_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_Interaction <- gseGO(gene_list.ADIPO_ASC_Interaction,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
            
gseGO_MF.ADIPO_ASC_Interaction <- simplify(gseGO_MF.ADIPO_ASC_Interaction)                        
gseGO_MF.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_SN_go_mf_dotplot, eval=ADIPO_ASC_Interaction.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_SN_go_mf_netplot, eval=ADIPO_ASC_Interaction.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_SN_go_mf_mapplot, eval=ADIPO_ASC_Interaction.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_Interaction)

emapplot(gseGO_MF.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_Interaction_SN_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_Interaction <- gseGO(gene_list.ADIPO_ASC_Interaction,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
             
gseGO_CC.ADIPO_ASC_Interaction <- simplify(gseGO_CC.ADIPO_ASC_Interaction)                       
gseGO_CC.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_SN_go_cc_dotplot, eval=ADIPO_ASC_Interaction.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_SN_go_cc_netplot, eval=ADIPO_ASC_Interaction.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_SN_go_cc_mapplot, eval=ADIPO_ASC_Interaction.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_Interaction)

emapplot(gseGO_CC.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_Interaction_SN_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_Interaction <- gseKEGG(gene_list.ADIPO_ASC_Interaction.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_Interaction <- setReadable(gseKEGG.ADIPO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_SN_kegg_dotplot, eval=ADIPO_ASC_Interaction.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_Interaction, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_SN_kegg_netplot, eval=ADIPO_ASC_Interaction.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_SN_kegg_mapplot, eval=ADIPO_ASC_Interaction.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_Interaction)

emapplot(gseKEGG.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_SN_kegg_pathview, eval=ADIPO_ASC_Interaction.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_Interaction.entrez, pathway.id = gseKEGG.ADIPO_ASC_Interaction@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_Interaction@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_Interaction_SN_do, warning=FALSE}

gseDO.ADIPO_ASC_Interaction <- gseDO(gene_list.ADIPO_ASC_Interaction.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_Interaction <- setReadable(gseDO.ADIPO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.DO.plot <- nrow(gseDO.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_SN_do_dotplot, eval=ADIPO_ASC_Interaction.DO.plot}

dotplot(gseDO.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_SN_do_netplot, eval=ADIPO_ASC_Interaction.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_Interaction, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_SN_do_mapplot, eval=ADIPO_ASC_Interaction.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_Interaction)

emapplot(gseDO.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


# Adipo ASC - Whole Cell Lysate

## Adipo ASC WT Light vs. Dark 

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_WT_Light_vs_Dark_WCL/"

dir.create(results_dir)

res.ADIPO_ASC_WT_Light_vs_Dark <- read.csv("results/DEA/ADIPO_ASC_WT_Light_vs_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_WT_Light_vs_Dark <- res.ADIPO_ASC_WT_Light_vs_Dark$logFC
names(gene_list.ADIPO_ASC_WT_Light_vs_Dark) <- res.ADIPO_ASC_WT_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_WT_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_WT_Light_vs_Dark[names(gene_list.ADIPO_ASC_WT_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez[!duplicated(names(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_WT_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark <- simplify(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark)
gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_bp_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_bp_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_bp_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_BP.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_WT_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark <- simplify(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark)
gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_mf_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_mf_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_mf_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_MF.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_cc, warning=FALSE}


gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_WT_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark <- simplify(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark)        
gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_cc_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_cc_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_go_cc_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_CC.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_WT_Light_vs_Dark <- gseKEGG(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_WT_Light_vs_Dark <- setReadable(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_kegg_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_kegg_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_kegg_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_kegg_pathview, eval=ADIPO_ASC_WT_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez, pathway.id = gseKEGG.ADIPO_ASC_WT_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_WT_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_do, warning=FALSE}

gseDO.ADIPO_ASC_WT_Light_vs_Dark <- gseDO(gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_WT_Light_vs_Dark <- setReadable(gseDO.ADIPO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_WT_Light_vs_Dark

ADIPO_ASC_WT_Light_vs_Dark.DO.plot <- nrow(gseDO.ADIPO_ASC_WT_Light_vs_Dark) > 0

if (ADIPO_ASC_WT_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_do_dotplot, eval=ADIPO_ASC_WT_Light_vs_Dark.DO.plot}

dotplot(gseDO.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_do_netplot, eval=ADIPO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_WT_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_WT_Light_vs_Dark_WCL_do_mapplot, eval=ADIPO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_WT_Light_vs_Dark)

emapplot(gseDO.ADIPO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC TLR10LOV Light vs. Dark 

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL/"

dir.create(results_dir)

res.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- read.csv("results/DEA/ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- res.ADIPO_ASC_TLR10LOV_Light_vs_Dark$logFC
names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark) <- res.ADIPO_ASC_TLR10LOV_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark[names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez[!duplicated(names(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark)
gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_BP.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark)  
gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_MF.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                 
gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark)   
gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_CC.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseKEGG(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_pathview, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez, pathway.id = gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_do, warning=FALSE}

gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- gseDO(gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark

ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot <- nrow(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_do_dotplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot}

dotplot(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_do_netplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_Light_vs_Dark_WCL_do_mapplot, eval=ADIPO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseDO.ADIPO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC TLR10LOV vs. WT Dark

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL/"

dir.create(results_dir)

res.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- read.csv("results/DEA/ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- res.ADIPO_ASC_TLR10LOV_vs_WT_Dark$logFC
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark) <- res.ADIPO_ASC_TLR10LOV_vs_WT_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark[names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez[!duplicated(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                             
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark)      
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseKEGG(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_pathview, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez, pathway.id = gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_do, warning=FALSE}

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- gseDO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark

ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot <- nrow(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_do_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot}

dotplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_do_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Dark_WCL_do_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC TLR10LOV vs. WT Light 

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL/"

dir.create(results_dir)

res.ADIPO_ASC_TLR10LOV_vs_WT_Light <- read.csv("results/DEA/ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light <- res.ADIPO_ASC_TLR10LOV_vs_WT_Light$logFC
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light) <- res.ADIPO_ASC_TLR10LOV_vs_WT_Light$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light[names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez[!duplicated(names(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp, warning=FALSE}

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light)
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_BP.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                         
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light)           
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_MF.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light)        
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_CC.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseKEGG(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_pathview, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez, pathway.id = gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_do, warning=FALSE}


gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light <- gseDO(gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light

ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot <- nrow(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light) > 0

if (ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_do_dotplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

dotplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_do_netplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

cnetplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_TLR10LOV_vs_WT_Light_WCL_do_mapplot, eval=ADIPO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseDO.ADIPO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Adipo ASC Interaction (TLR10LOV Light vs. Dark) vs. (Wildtype Light vs. Dark)

```{r ADIPO_ASC_Interaction_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/ADIPO_ASC_Interaction_WCL/"

dir.create(results_dir)

res.ADIPO_ASC_Interaction <- read.csv("results/DEA/ADIPO_ASC_Interaction_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.ADIPO_ASC_Interaction <- res.ADIPO_ASC_Interaction$logFC
names(gene_list.ADIPO_ASC_Interaction) <- res.ADIPO_ASC_Interaction$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.ADIPO_ASC_Interaction), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.ADIPO_ASC_Interaction.entrez <- gene_list.ADIPO_ASC_Interaction[names(gene_list.ADIPO_ASC_Interaction) %in% ids$SYMBOL]
names(gene_list.ADIPO_ASC_Interaction.entrez) <- ids$ENTREZID
gene_list.ADIPO_ASC_Interaction.entrez <- gene_list.ADIPO_ASC_Interaction.entrez[!duplicated(names(gene_list.ADIPO_ASC_Interaction.entrez))]

```

### Gene ontology

#### Biological Processes

```{r ADIPO_ASC_Interaction_WCL_go_bp, warning=FALSE}


gseGO_BP.ADIPO_ASC_Interaction <- gseGO(gene_list.ADIPO_ASC_Interaction,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.ADIPO_ASC_Interaction <- simplify(gseGO_BP.ADIPO_ASC_Interaction)
gseGO_BP.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.go_bp.plot <- nrow(gseGO_BP.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_WCL_go_bp_dotplot, eval=ADIPO_ASC_Interaction.go_bp.plot}

dotplot(gseGO_BP.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_WCL_go_bp_netplot, eval=ADIPO_ASC_Interaction.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_WCL_go_bp_mapplot, eval=ADIPO_ASC_Interaction.go_bp.plot, fig.height=9}
gseGO_BP.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_BP.ADIPO_ASC_Interaction)

emapplot(gseGO_BP.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r ADIPO_ASC_Interaction_WCL_go_mf, warning=FALSE}

gseGO_MF.ADIPO_ASC_Interaction <- gseGO(gene_list.ADIPO_ASC_Interaction,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
            
gseGO_MF.ADIPO_ASC_Interaction <- simplify(gseGO_MF.ADIPO_ASC_Interaction)                        
gseGO_MF.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.go_mf.plot <- nrow(gseGO_MF.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_WCL_go_mf_dotplot, eval=ADIPO_ASC_Interaction.go_mf.plot}

dotplot(gseGO_MF.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_WCL_go_mf_netplot, eval=ADIPO_ASC_Interaction.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_WCL_go_mf_mapplot, eval=ADIPO_ASC_Interaction.go_mf.plot, fig.height=9}
gseGO_MF.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_MF.ADIPO_ASC_Interaction)

emapplot(gseGO_MF.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r ADIPO_ASC_Interaction_WCL_go_cc, warning=FALSE}

gseGO_CC.ADIPO_ASC_Interaction <- gseGO(gene_list.ADIPO_ASC_Interaction,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
             
gseGO_CC.ADIPO_ASC_Interaction <- simplify(gseGO_CC.ADIPO_ASC_Interaction)                       
gseGO_CC.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.go_cc.plot <- nrow(gseGO_CC.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_WCL_go_cc_dotplot, eval=ADIPO_ASC_Interaction.go_cc.plot}

dotplot(gseGO_CC.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_WCL_go_cc_netplot, eval=ADIPO_ASC_Interaction.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_WCL_go_cc_mapplot, eval=ADIPO_ASC_Interaction.go_cc.plot, fig.height=9}
gseGO_CC.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_CC.ADIPO_ASC_Interaction)

emapplot(gseGO_CC.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r ADIPO_ASC_Interaction_WCL_kegg, warning=FALSE}

gseKEGG.ADIPO_ASC_Interaction <- gseKEGG(gene_list.ADIPO_ASC_Interaction.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.ADIPO_ASC_Interaction <- setReadable(gseKEGG.ADIPO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseKEGG.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.kegg.plot <- nrow(gseKEGG.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.kegg.plot) {
  write.csv(data.frame(gseKEGG.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_WCL_kegg_dotplot, eval=ADIPO_ASC_Interaction.kegg.plot}

dotplot(gseKEGG.ADIPO_ASC_Interaction, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_WCL_kegg_netplot, eval=ADIPO_ASC_Interaction.kegg.plot, fig.height=10}

cnetplot(gseKEGG.ADIPO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_WCL_kegg_mapplot, eval=ADIPO_ASC_Interaction.kegg.plot, fig.height=9}
gseKEGG.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseKEGG.ADIPO_ASC_Interaction)

emapplot(gseKEGG.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_WCL_kegg_pathview, eval=ADIPO_ASC_Interaction.kegg.plot}

pathview(gene.data = gene_list.ADIPO_ASC_Interaction.entrez, pathway.id = gseKEGG.ADIPO_ASC_Interaction@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.ADIPO_ASC_Interaction@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r ADIPO_ASC_Interaction_WCL_do, warning=FALSE}

gseDO.ADIPO_ASC_Interaction <- gseDO(gene_list.ADIPO_ASC_Interaction.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.ADIPO_ASC_Interaction <- setReadable(gseDO.ADIPO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseDO.ADIPO_ASC_Interaction

ADIPO_ASC_Interaction.DO.plot <- nrow(gseDO.ADIPO_ASC_Interaction) > 0

if (ADIPO_ASC_Interaction.DO.plot) {
  write.csv(data.frame(gseDO.ADIPO_ASC_Interaction), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r ADIPO_ASC_Interaction_WCL_do_dotplot, eval=ADIPO_ASC_Interaction.DO.plot}

dotplot(gseDO.ADIPO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r ADIPO_ASC_Interaction_WCL_do_netplot, eval=ADIPO_ASC_Interaction.DO.plot, fig.height=10}

cnetplot(gseDO.ADIPO_ASC_Interaction, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.ADIPO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r ADIPO_ASC_Interaction_WCL_do_mapplot, eval=ADIPO_ASC_Interaction.DO.plot, fig.height=9}

gseDO.ADIPO_ASC_Interaction.pwts <- pairwise_termsim(gseDO.ADIPO_ASC_Interaction)

emapplot(gseDO.ADIPO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


# Osteo ASC - Supernatant

## Osteo ASC WT Light vs. Dark 

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_WT_Light_vs_Dark_SN/"

dir.create(results_dir)

res.OSTEO_ASC_WT_Light_vs_Dark <- read.csv("results/DEA/OSTEO_ASC_WT_Light_vs_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_WT_Light_vs_Dark <- res.OSTEO_ASC_WT_Light_vs_Dark$logFC
names(gene_list.OSTEO_ASC_WT_Light_vs_Dark) <- res.OSTEO_ASC_WT_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_WT_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_WT_Light_vs_Dark[names(gene_list.OSTEO_ASC_WT_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez[!duplicated(names(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_WT_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark <- simplify(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark)
gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_bp_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_bp_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_bp_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_WT_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark <- simplify(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark)
gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_mf_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_mf_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_mf_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_cc, warning=FALSE}


gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_WT_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark <- simplify(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark)        
gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_cc_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_cc_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_go_cc_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_WT_Light_vs_Dark <- gseKEGG(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_WT_Light_vs_Dark <- setReadable(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_kegg_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_kegg_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_kegg_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_kegg_pathview, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez, pathway.id = gseKEGG.OSTEO_ASC_WT_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_do, warning=FALSE}

gseDO.OSTEO_ASC_WT_Light_vs_Dark <- gseDO(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_WT_Light_vs_Dark <- setReadable(gseDO.OSTEO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.DO.plot <- nrow(gseDO.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_do_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.DO.plot}

dotplot(gseDO.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_do_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_SN_do_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseDO.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC TLR10LOV Light vs. Dark 

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN/"

dir.create(results_dir)

res.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- read.csv("results/DEA/OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- res.OSTEO_ASC_TLR10LOV_Light_vs_Dark$logFC
names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark) <- res.OSTEO_ASC_TLR10LOV_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark[names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez[!duplicated(names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark)
gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_bp_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark)  
gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_mf_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                 
gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark)   
gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_go_cc_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseKEGG(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_kegg_pathview, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez, pathway.id = gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_do, warning=FALSE}

gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseDO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot <- nrow(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_do_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot}

dotplot(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_do_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_SN_do_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC TLR10LOV vs. WT Dark

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN/"

dir.create(results_dir)

res.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- read.csv("results/DEA/OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- res.OSTEO_ASC_TLR10LOV_vs_WT_Dark$logFC
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark) <- res.OSTEO_ASC_TLR10LOV_vs_WT_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark[names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez[!duplicated(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_bp_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                             
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark)      
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_mf_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_go_cc_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseKEGG(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_kegg_pathview, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez, pathway.id = gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_do, warning=FALSE}

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseDO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot <- nrow(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_do_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot}

dotplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_do_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_SN_do_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC TLR10LOV vs. WT Light 

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_TLR10LOV_vs_WT_Light_SN/"

dir.create(results_dir)

res.OSTEO_ASC_TLR10LOV_vs_WT_Light <- read.csv("results/DEA/OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light <- res.OSTEO_ASC_TLR10LOV_vs_WT_Light$logFC
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light) <- res.OSTEO_ASC_TLR10LOV_vs_WT_Light$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light[names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez[!duplicated(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light)
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_bp_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                         
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light)           
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_mf_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light)        
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_go_cc_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseKEGG(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_kegg_pathview, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez, pathway.id = gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_do, warning=FALSE}


gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseDO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot <- nrow(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_do_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

dotplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_do_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

cnetplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_SN_do_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC Interaction (TLR10LOV Light vs. Dark) vs. (Wildtype Light vs. Dark)

```{r OSTEO_ASC_Interaction_SN_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_Interaction_SN/"

dir.create(results_dir)

res.OSTEO_ASC_Interaction <- read.csv("results/DEA/OSTEO_ASC_Interaction_SN_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_Interaction <- res.OSTEO_ASC_Interaction$logFC
names(gene_list.OSTEO_ASC_Interaction) <- res.OSTEO_ASC_Interaction$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_Interaction), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_Interaction.entrez <- gene_list.OSTEO_ASC_Interaction[names(gene_list.OSTEO_ASC_Interaction) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_Interaction.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_Interaction.entrez <- gene_list.OSTEO_ASC_Interaction.entrez[!duplicated(names(gene_list.OSTEO_ASC_Interaction.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_Interaction_SN_go_bp, warning=FALSE}


gseGO_BP.OSTEO_ASC_Interaction <- gseGO(gene_list.OSTEO_ASC_Interaction,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_Interaction <- simplify(gseGO_BP.OSTEO_ASC_Interaction)
gseGO_BP.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_SN_go_bp_dotplot, eval=OSTEO_ASC_Interaction.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_SN_go_bp_netplot, eval=OSTEO_ASC_Interaction.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_SN_go_bp_mapplot, eval=OSTEO_ASC_Interaction.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_Interaction)

emapplot(gseGO_BP.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_Interaction_SN_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_Interaction <- gseGO(gene_list.OSTEO_ASC_Interaction,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
            
gseGO_MF.OSTEO_ASC_Interaction <- simplify(gseGO_MF.OSTEO_ASC_Interaction)                        
gseGO_MF.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_SN_go_mf_dotplot, eval=OSTEO_ASC_Interaction.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_SN_go_mf_netplot, eval=OSTEO_ASC_Interaction.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_SN_go_mf_mapplot, eval=OSTEO_ASC_Interaction.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_Interaction)

emapplot(gseGO_MF.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_Interaction_SN_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_Interaction <- gseGO(gene_list.OSTEO_ASC_Interaction,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
             
gseGO_CC.OSTEO_ASC_Interaction <- simplify(gseGO_CC.OSTEO_ASC_Interaction)                       
gseGO_CC.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_SN_go_cc_dotplot, eval=OSTEO_ASC_Interaction.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_SN_go_cc_netplot, eval=OSTEO_ASC_Interaction.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_SN_go_cc_mapplot, eval=OSTEO_ASC_Interaction.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_Interaction)

emapplot(gseGO_CC.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_Interaction_SN_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_Interaction <- gseKEGG(gene_list.OSTEO_ASC_Interaction.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_Interaction <- setReadable(gseKEGG.OSTEO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_SN_kegg_dotplot, eval=OSTEO_ASC_Interaction.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_Interaction, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_SN_kegg_netplot, eval=OSTEO_ASC_Interaction.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_SN_kegg_mapplot, eval=OSTEO_ASC_Interaction.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_Interaction)

emapplot(gseKEGG.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_SN_kegg_pathview, eval=OSTEO_ASC_Interaction.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_Interaction.entrez, pathway.id = gseKEGG.OSTEO_ASC_Interaction@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_Interaction@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_Interaction_SN_do, warning=FALSE}

gseDO.OSTEO_ASC_Interaction <- gseDO(gene_list.OSTEO_ASC_Interaction.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_Interaction <- setReadable(gseDO.OSTEO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.DO.plot <- nrow(gseDO.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_SN_do_dotplot, eval=OSTEO_ASC_Interaction.DO.plot}

dotplot(gseDO.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_SN_do_netplot, eval=OSTEO_ASC_Interaction.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_Interaction, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_SN_do_mapplot, eval=OSTEO_ASC_Interaction.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_Interaction)

emapplot(gseDO.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


# Osteo ASC - Whole Cell Lysate

## Osteo ASC WT Light vs. Dark 

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_WT_Light_vs_Dark_WCL/"

dir.create(results_dir)

res.OSTEO_ASC_WT_Light_vs_Dark <- read.csv("results/DEA/OSTEO_ASC_WT_Light_vs_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_WT_Light_vs_Dark <- res.OSTEO_ASC_WT_Light_vs_Dark$logFC
names(gene_list.OSTEO_ASC_WT_Light_vs_Dark) <- res.OSTEO_ASC_WT_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_WT_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_WT_Light_vs_Dark[names(gene_list.OSTEO_ASC_WT_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez[!duplicated(names(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_WT_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark <- simplify(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark)
gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_bp_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_bp_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_bp_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_BP.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_WT_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark <- simplify(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark)
gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_mf_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_mf_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_mf_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_MF.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_cc, warning=FALSE}


gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_WT_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark <- simplify(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark)        
gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_cc_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_cc_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_go_cc_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseGO_CC.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_WT_Light_vs_Dark <- gseKEGG(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_WT_Light_vs_Dark <- setReadable(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_kegg_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_kegg_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_kegg_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_kegg_pathview, eval=OSTEO_ASC_WT_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez, pathway.id = gseKEGG.OSTEO_ASC_WT_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_WT_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_do, warning=FALSE}

gseDO.OSTEO_ASC_WT_Light_vs_Dark <- gseDO(gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_WT_Light_vs_Dark <- setReadable(gseDO.OSTEO_ASC_WT_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_WT_Light_vs_Dark

OSTEO_ASC_WT_Light_vs_Dark.DO.plot <- nrow(gseDO.OSTEO_ASC_WT_Light_vs_Dark) > 0

if (OSTEO_ASC_WT_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_WT_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_do_dotplot, eval=OSTEO_ASC_WT_Light_vs_Dark.DO.plot}

dotplot(gseDO.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_do_netplot, eval=OSTEO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_WT_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_WT_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_WT_Light_vs_Dark_WCL_do_mapplot, eval=OSTEO_ASC_WT_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_WT_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_WT_Light_vs_Dark)

emapplot(gseDO.OSTEO_ASC_WT_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC TLR10LOV Light vs. Dark 

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL/"

dir.create(results_dir)

res.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- read.csv("results/DEA/OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- res.OSTEO_ASC_TLR10LOV_Light_vs_Dark$logFC
names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark) <- res.OSTEO_ASC_TLR10LOV_Light_vs_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark[names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez[!duplicated(names(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark)
gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_bp_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_BP.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark)  
gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_mf_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_MF.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                 
gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- simplify(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark)   
gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_go_cc_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseGO_CC.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseKEGG(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_kegg_pathview, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez, pathway.id = gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_TLR10LOV_Light_vs_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_do, warning=FALSE}

gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- gseDO(gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark <- setReadable(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark

OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot <- nrow(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark) > 0

if (OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_do_dotplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot}

dotplot(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_do_netplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_Light_vs_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_Light_vs_Dark_WCL_do_mapplot, eval=OSTEO_ASC_TLR10LOV_Light_vs_Dark.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark)

emapplot(gseDO.OSTEO_ASC_TLR10LOV_Light_vs_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC TLR10LOV vs. WT Dark

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL/"

dir.create(results_dir)

res.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- read.csv("results/DEA/OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- res.OSTEO_ASC_TLR10LOV_vs_WT_Dark$logFC
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark) <- res.OSTEO_ASC_TLR10LOV_vs_WT_Dark$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark[names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez[!duplicated(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_bp_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                             
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark)      
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_mf_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                                    
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- simplify(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark)
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_go_cc_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseKEGG(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_kegg_pathview, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez, pathway.id = gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Dark@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_do, warning=FALSE}

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- gseDO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark <- setReadable(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark

OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot <- nrow(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_do_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot}

dotplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_do_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Dark.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Dark_WCL_do_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Dark.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark)

emapplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Dark.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC TLR10LOV vs. WT Light 

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL/"

dir.create(results_dir)

res.OSTEO_ASC_TLR10LOV_vs_WT_Light <- read.csv("results/DEA/OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light <- res.OSTEO_ASC_TLR10LOV_vs_WT_Light$logFC
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light) <- res.OSTEO_ASC_TLR10LOV_vs_WT_Light$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light[names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez <- gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez[!duplicated(names(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp, warning=FALSE}

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light)
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_bp_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_BP.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                         
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light)           
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_mf_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_MF.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseGO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
                            
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light <- simplify(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light)        
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_go_cc_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseGO_CC.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseKEGG(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_kegg_pathview, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez, pathway.id = gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_TLR10LOV_vs_WT_Light@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_do, warning=FALSE}


gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light <- gseDO(gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light <- setReadable(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light

OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot <- nrow(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light) > 0

if (OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_do_dotplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

dotplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_do_netplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

cnetplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_TLR10LOV_vs_WT_Light.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_TLR10LOV_vs_WT_Light_WCL_do_mapplot, eval=OSTEO_ASC_TLR10LOV_vs_WT_Light.DO.plot}

gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light)

emapplot(gseDO.OSTEO_ASC_TLR10LOV_vs_WT_Light.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```


## Osteo ASC Interaction (TLR10LOV Light vs. Dark) vs. (Wildtype Light vs. Dark)

```{r OSTEO_ASC_Interaction_WCL_import, warning=FALSE}

results_dir <- "./results/GSEA/OSTEO_ASC_Interaction_WCL/"

dir.create(results_dir)

res.OSTEO_ASC_Interaction <- read.csv("results/DEA/OSTEO_ASC_Interaction_WCL_unfiltered.csv") %>%
  as_tibble() %>%
  arrange(desc(logFC))

gene_list.OSTEO_ASC_Interaction <- res.OSTEO_ASC_Interaction$logFC
names(gene_list.OSTEO_ASC_Interaction) <- res.OSTEO_ASC_Interaction$gene

# Convert to ENTREZID (for KEGG)
ids <- bitr(names(gene_list.OSTEO_ASC_Interaction), fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)
ids <- ids[!duplicated(ids$SYMBOL),]

gene_list.OSTEO_ASC_Interaction.entrez <- gene_list.OSTEO_ASC_Interaction[names(gene_list.OSTEO_ASC_Interaction) %in% ids$SYMBOL]
names(gene_list.OSTEO_ASC_Interaction.entrez) <- ids$ENTREZID
gene_list.OSTEO_ASC_Interaction.entrez <- gene_list.OSTEO_ASC_Interaction.entrez[!duplicated(names(gene_list.OSTEO_ASC_Interaction.entrez))]

```

### Gene ontology

#### Biological Processes

```{r OSTEO_ASC_Interaction_WCL_go_bp, warning=FALSE}


gseGO_BP.OSTEO_ASC_Interaction <- gseGO(gene_list.OSTEO_ASC_Interaction,
                                    ont = "BP",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")

gseGO_BP.OSTEO_ASC_Interaction <- simplify(gseGO_BP.OSTEO_ASC_Interaction)
gseGO_BP.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.go_bp.plot <- nrow(gseGO_BP.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.go_bp.plot) {
  write.csv(data.frame(gseGO_BP.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_WCL_go_bp_dotplot, eval=OSTEO_ASC_Interaction.go_bp.plot}

dotplot(gseGO_BP.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_WCL_go_bp_netplot, eval=OSTEO_ASC_Interaction.go_bp.plot, fig.height=10}

cnetplot(gseGO_BP.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_WCL_go_bp_mapplot, eval=OSTEO_ASC_Interaction.go_bp.plot, fig.height=9}
gseGO_BP.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_BP.OSTEO_ASC_Interaction)

emapplot(gseGO_BP.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Molecular Function

```{r OSTEO_ASC_Interaction_WCL_go_mf, warning=FALSE}

gseGO_MF.OSTEO_ASC_Interaction <- gseGO(gene_list.OSTEO_ASC_Interaction,
                                    ont = "MF",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
            
gseGO_MF.OSTEO_ASC_Interaction <- simplify(gseGO_MF.OSTEO_ASC_Interaction)                        
gseGO_MF.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.go_mf.plot <- nrow(gseGO_MF.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.go_mf.plot) {
  write.csv(data.frame(gseGO_MF.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_WCL_go_mf_dotplot, eval=OSTEO_ASC_Interaction.go_mf.plot}

dotplot(gseGO_MF.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_WCL_go_mf_netplot, eval=OSTEO_ASC_Interaction.go_mf.plot, fig.height=10}

cnetplot(gseGO_MF.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_WCL_go_mf_mapplot, eval=OSTEO_ASC_Interaction.go_mf.plot, fig.height=9}
gseGO_MF.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_MF.OSTEO_ASC_Interaction)

emapplot(gseGO_MF.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

#### Cellular Component

```{r OSTEO_ASC_Interaction_WCL_go_cc, warning=FALSE}

gseGO_CC.OSTEO_ASC_Interaction <- gseGO(gene_list.OSTEO_ASC_Interaction,
                                    ont = "CC",
                                    OrgDb = org.Hs.eg.db,
                                    keyType = "SYMBOL")
             
gseGO_CC.OSTEO_ASC_Interaction <- simplify(gseGO_CC.OSTEO_ASC_Interaction)                       
gseGO_CC.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.go_cc.plot <- nrow(gseGO_CC.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.go_cc.plot) {
  write.csv(data.frame(gseGO_CC.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_go.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_WCL_go_cc_dotplot, eval=OSTEO_ASC_Interaction.go_cc.plot}

dotplot(gseGO_CC.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_WCL_go_cc_netplot, eval=OSTEO_ASC_Interaction.go_cc.plot, fig.height=10}

cnetplot(gseGO_CC.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_WCL_go_cc_mapplot, eval=OSTEO_ASC_Interaction.go_cc.plot, fig.height=9}
gseGO_CC.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseGO_CC.OSTEO_ASC_Interaction)

emapplot(gseGO_CC.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")
```

### KEGG (Kyoto Encyclopedia of Genes and Genomes)

```{r OSTEO_ASC_Interaction_WCL_kegg, warning=FALSE}

gseKEGG.OSTEO_ASC_Interaction <- gseKEGG(gene_list.OSTEO_ASC_Interaction.entrez,
                         organism = "hsa",
                         keyType = "ncbi-geneid",
                         eps = 0)

gseKEGG.OSTEO_ASC_Interaction <- setReadable(gseKEGG.OSTEO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseKEGG.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.kegg.plot <- nrow(gseKEGG.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.kegg.plot) {
  write.csv(data.frame(gseKEGG.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_kegg.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_WCL_kegg_dotplot, eval=OSTEO_ASC_Interaction.kegg.plot}

dotplot(gseKEGG.OSTEO_ASC_Interaction, showCategory = 15, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_WCL_kegg_netplot, eval=OSTEO_ASC_Interaction.kegg.plot, fig.height=10}

cnetplot(gseKEGG.OSTEO_ASC_Interaction, showCategory = 5, color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_WCL_kegg_mapplot, eval=OSTEO_ASC_Interaction.kegg.plot, fig.height=9}
gseKEGG.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseKEGG.OSTEO_ASC_Interaction)

emapplot(gseKEGG.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_WCL_kegg_pathview, eval=OSTEO_ASC_Interaction.kegg.plot}

pathview(gene.data = gene_list.OSTEO_ASC_Interaction.entrez, pathway.id = gseKEGG.OSTEO_ASC_Interaction@result$ID[1], species = "hsa")

filename <- paste0(gseKEGG.OSTEO_ASC_Interaction@result$ID[1], ".pathview.png")

file.rename(filename, paste0(results_dir, filename))

knitr::include_graphics(paste0(results_dir, filename))

```

### Disease ontology

```{r OSTEO_ASC_Interaction_WCL_do, warning=FALSE}

gseDO.OSTEO_ASC_Interaction <- gseDO(gene_list.OSTEO_ASC_Interaction.entrez,
                     eps = 0,
                     maxGSSize = 500,
                     minGSSize = 15)

gseDO.OSTEO_ASC_Interaction <- setReadable(gseDO.OSTEO_ASC_Interaction, "org.Hs.eg.db", "ENTREZID")
gseDO.OSTEO_ASC_Interaction

OSTEO_ASC_Interaction.DO.plot <- nrow(gseDO.OSTEO_ASC_Interaction) > 0

if (OSTEO_ASC_Interaction.DO.plot) {
  write.csv(data.frame(gseDO.OSTEO_ASC_Interaction), file = file.path(results_dir, "gsea_do.csv"), row.names = F)
}

```

```{r OSTEO_ASC_Interaction_WCL_do_dotplot, eval=OSTEO_ASC_Interaction.DO.plot}

dotplot(gseDO.OSTEO_ASC_Interaction, showCategory = 10, size = NULL, split = ".sign", font.size = 9, label_format = 40) + 
  facet_grid(~.sign) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```

```{r OSTEO_ASC_Interaction_WCL_do_netplot, eval=OSTEO_ASC_Interaction.DO.plot, fig.height=10}

cnetplot(gseDO.OSTEO_ASC_Interaction, showCategory = 5, layout = "dh", color.params = list(foldChange = gene_list.OSTEO_ASC_Interaction.entrez),
         cex.params = list(category_label = 0.6, gene_label = 0.4)) +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", limits = c(-2, 2), name = "Fold Change", oob = scales::squish)

```

```{r OSTEO_ASC_Interaction_WCL_do_mapplot, eval=OSTEO_ASC_Interaction.DO.plot, fig.height=9}

gseDO.OSTEO_ASC_Interaction.pwts <- pairwise_termsim(gseDO.OSTEO_ASC_Interaction)

emapplot(gseDO.OSTEO_ASC_Interaction.pwts, force = 1.5,
         cex.params = list(category_label = 0.8)) +
  scale_fill_gradient(low = "red", high = "white", limits = c(0, 0.05), name = "adj. p-value")

```
